<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:WeatherApp.ViewModels"
             xmlns:charts="clr-namespace:LiveChartsCore.SkiaSharpView.Maui;assembly=LiveChartsCore.SkiaSharpView.Maui"
             x:Class="WeatherApp.Views.MainPage"
             x:DataType="vm:MainViewModel"
             Title="Weather App">

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="15">

            <Button Text="Load Weather" Command="{Binding LoadWeatherCommand}" />

            <ActivityIndicator IsRunning="{Binding IsLoading}" IsVisible="{Binding IsLoading}" />

        <!-- Current Weather Section -->
        <Border StrokeThickness="2" Stroke="LightBlue" BackgroundColor="White" Padding="15">
            <Border.StrokeShape>
                <RoundRectangle CornerRadius="20"/>
            </Border.StrokeShape>
    
            <VerticalStackLayout Spacing="5" HorizontalOptions="Center">
                <!-- Location Name -->
                <Label Text="{Binding LocationName}" 
                       FontSize="24" 
                       FontAttributes="Bold" 
                       HorizontalOptions="Center" 
                       TextColor="DarkBlue"/>
        
                <!-- Weather Condition -->
                <HorizontalStackLayout HorizontalOptions="Center" Spacing="5">
                        <Label Text="{Binding CurrentWeather.CurrentWeather.WeatherCode, Converter={StaticResource WeatherCodeToTextConverter}}" 
                           FontSize="22" 
                           TextColor="Black"/>
                </HorizontalStackLayout>

                <!-- Temperature -->
                <Label Text="{Binding CurrentWeather.CurrentWeather.Temperature, StringFormat='{0}Â°C'}" 
                       FontSize="50" 
                       FontAttributes="Bold" 
                       HorizontalOptions="Center" 
                       VerticalOptions="Center" 
                       TextColor="DarkBlue"/>

                <!-- Wind Speed -->
                <Label Text="{Binding CurrentWeather.CurrentWeather.WindSpeed, StringFormat='Wind: {0} km/h'}" 
                       FontSize="18" 
                       HorizontalOptions="Center" 
                       TextColor="Gray"/>
            </VerticalStackLayout>
        </Border>


            <!-- Forecast Chart (24-Hour Temperature Trend) -->
            <Label Text="Temperature Trend (Next 24 Hours)" FontSize="20" FontAttributes="Bold" HorizontalOptions="Center"/>
            <charts:CartesianChart Series="{Binding TemperatureChartSeries}"
                               XAxes="{Binding TemperatureChartXAxis}"
                               HeightRequest="250"
                               BackgroundColor="Transparent"/>

            <!-- 5-Day Forecast Chart -->
            <Label Text="5-Day Forecast (Temperature Range)" FontSize="20" FontAttributes="Bold" HorizontalOptions="Center"/>
            <charts:CartesianChart Series="{Binding FiveDayForecastSeries}"
                       XAxes="{Binding FiveDayForecastXAxis}"
                       HeightRequest="250"
                       BackgroundColor="Transparent"/>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
